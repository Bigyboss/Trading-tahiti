<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tahiti Trading Terminal PRO + Dynamic Algo</title>
    <style>
        :root {
            --bg: #0b0e11;
            --card: #1e2329;
            --green: #02c076;
            --red: #f84960;
            --yellow: #f0b90b;
            --text: #eaecef;
            --gray: #848e9c;
            --blue: #3498db;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 15px; margin: 0; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 1000px; }
        
        #alert-march { 
            background: var(--yellow); color: black; width: 100%; padding: 10px; 
            text-align: center; font-weight: bold; border-radius: 8px; margin-bottom: 15px;
            display: none; font-size: 0.9rem;
        }

        .header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 20px; background: var(--card); padding: 20px; 
            border-radius: 12px; border-bottom: 4px solid var(--yellow);
        }
        .clock { font-size: 2.2rem; font-weight: bold; font-family: monospace; color: var(--yellow); }
        
        .season-switch { background: #2b3139; padding: 10px; border-radius: 8px; display: flex; gap: 10px; align-items: center; border: 1px solid #333; }
        .btn-season { 
            padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; 
            background: transparent; color: var(--gray); font-weight: bold; transition: 0.3s;
        }
        .btn-season.active { background: var(--yellow); color: black; }

        table { width: 100%; border-collapse: separate; border-spacing: 0 8px; margin-bottom: 20px; }
        th { text-align: left; padding: 12px; color: var(--gray); font-size: 0.85rem; }
        tr { background: var(--card); }
        td { padding: 15px; border: none; font-size: 0.95rem; }
        td:first-child { border-radius: 8px 0 0 8px; font-weight: bold; }
        td:last-child { border-radius: 0 8px 8px 0; text-align: right; }

        .status-badge { padding: 6px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        .open { color: var(--green); border: 1px solid var(--green); }
        .closed { color: var(--red); border: 1px solid var(--red); opacity: 0.6; }

        .algo-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: 10px; margin-bottom: 30px; }
        .algo-card { background: var(--card); padding: 15px; border-radius: 8px; border-left: 3px solid var(--blue); transition: 0.3s; }
        .algo-time { color: var(--yellow); font-weight: bold; font-size: 1.1rem; }
        .algo-title { font-size: 0.85rem; color: var(--text); margin-top: 5px; }
        .algo-active { border-left: 5px solid var(--green); background: rgba(2, 192, 118, 0.1); transform: scale(1.02); }

        .section-title { margin: 25px 0 15px 5px; font-weight: bold; color: var(--yellow); font-size: 1rem; display: flex; align-items: center; }
        .section-title::after { content: ""; flex: 1; height: 1px; background: #333; margin-left: 15px; }
        .calendar-wrapper { border-radius: 12px; overflow: hidden; height: 500px; background: var(--card); }
    </style>
</head>
<body>

<div class="container">
    <div id="alert-march">‚ö†Ô∏è Rappel : New York passe √† l'heure d'√©t√© le 8 Mars. Pensez √† cliquer sur "SUMMER" !</div>

    <div class="header">
        <div>
            <div style="color: var(--gray); font-size: 0.9rem;">TAHITI TIME</div>
            <div class="clock" id="clock">00:00:00</div>
            <div id="date" style="font-size: 0.9rem; color: var(--text);">--</div>
        </div>
        
        <div class="season-switch">
            <span style="font-size: 0.8rem; color: var(--gray);">US/EU SEASON :</span>
            <button class="btn-season active" id="btn-hiver" onclick="setSeason('hiver')">WINTER</button>
            <button class="btn-season" id="btn-ete" onclick="setSeason('ete')">SUMMER</button>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>March√©</th>
                <th>Horaires (TAHT)</th>
                <th style="text-align: right;">Statut</th>
            </tr>
        </thead>
        <tbody id="market-list"></tbody>
    </table>

    <div class="section-title">ü§ñ Activation Algos (Ajustement Dynamique)</div>
    <div class="algo-grid" id="algo-list"></div>

    <div class="section-title">üìÖ Calendrier √âconomique</div>
    <div class="calendar-wrapper">
        <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
            { "colorTheme": "dark", "isMaximized": true, "width": "100%", "height": "100%", "locale": "fr", "importanceFilter": "0,1", "countryFilter": "us,eu,gb,jp,au" }
            </script>
        </div>
    </div>
</div>

<script>
    let currentSeason = 'hiver';

    const config = {
        hiver: {
            markets: [
                { name: "FUTURES US (NQ/ES)", open: "13:00", close: "12:00" },
                { name: "NYSE (Actions)", open: "04:30", close: "11:00" },
                { name: "ASX (Australie)", open: "13:00", close: "19:00" }
            ],
            algos: [
                { time: "20:30", label: "Algos Europe (Pre-market)" },
                { time: "22:00", label: "Open Cash Europe (Volatilit√©)" },
                { time: "02:00", label: "London Fix (Rebalancing)" },
                { time: "04:30", label: "Open Cash NY (Wall Street)" },
                { time: "09:00", label: "NY Options / Re-fix" },
                { time: "11:00", label: "MOC Algos (Fin de session)" }
            ]
        },
        ete: {
            markets: [
                { name: "FUTURES US (NQ/ES)", open: "12:00", close: "11:00" },
                { name: "NYSE (Actions)", open: "03:30", close: "10:00" },
                { name: "ASX (Australie)", open: "14:00", close: "20:00" }
            ],
            algos: [
                { time: "19:30", label: "Algos Europe (Pre-market)" },
                { time: "21:00", label: "Open Cash Europe (Volatilit√©)" },
                { time: "01:00", label: "London Fix (Rebalancing)" },
                { time: "03:30", label: "Open Cash NY (Wall Street)" },
                { time: "08:00", label: "NY Options / Re-fix" },
                { time: "10:00", label: "MOC Algos (Fin de session)" }
            ]
        },
        fixe: [
            { name: "TSE (Japon)", open: "14:00", close: "20:00" },
            { name: "HKEX (Hong Kong)", open: "15:30", close: "22:00" },
            { name: "EUROPE (DAX/CAC)", open: "22:00", close: "06:30" }
        ]
    };

    function setSeason(s) {
        currentSeason = s;
        document.getElementById('btn-hiver').classList.toggle('active', s === 'hiver');
        document.getElementById('btn-ete').classList.toggle('active', s === 'ete');
        update();
    }

    function timeToMin(timeStr) {
        const [h, m] = timeStr.split(':').map(Number);
        return h * 60 + m;
    }

    function update() {
        const now = new Date();
        const curMin = now.getHours() * 60 + now.getMinutes();
        if(now.getMonth() === 2 && now.getDate() <= 10) document.getElementById('alert-march').style.display = 'block';

        document.getElementById('clock').innerText = now.toLocaleTimeString('fr-FR');
        document.getElementById('date').innerText = now.toLocaleDateString('fr-FR', {weekday: 'long', day: 'numeric', month: 'long'});

        // Update March√©s
        const currentMarkets = [...config[currentSeason].markets, ...config.fixe];
        let marketHtml = '';
        currentMarkets.forEach(m => {
            const start = timeToMin(m.open);
            const end = timeToMin(m.close);
            let isOpen = (start < end) ? (curMin >= start && curMin < end) : (curMin >= start || curMin < end);
            marketHtml += `<tr><td>${m.name}</td><td>${m.open} - ${m.close}</td><td style="text-align: right;"><span class="status-badge ${isOpen ? 'open' : 'closed'}">${isOpen ? '‚óè OUVERT' : '‚óã FERM√â'}</span></td></tr>`;
        });
        document.getElementById('market-list').innerHTML = marketHtml;

        // Update Dynamic Algos
        let algoHtml = '';
        config[currentSeason].algos.forEach(a => {
            const aMin = timeToMin(a.time);
            const isActive = curMin >= aMin && curMin < (aMin + 15);
            algoHtml += `
                <div class="algo-card ${isActive ? 'algo-active' : ''}">
                    <div class="algo-time">${a.time} ${isActive ? '‚ö°' : ''}</div>
                    <div class="algo-title">${a.label}</div>
                    ${isActive ? '<div style="font-size:0.7rem; color:var(--green); margin-top:5px; font-weight:bold;">ACTIVATION EN COURS...</div>' : ''}
                </div>`;
        });
        document.getElementById('algo-list').innerHTML = algoHtml;
    }

    setInterval(update, 1000);
    update();
</script>
</body>
</html>
